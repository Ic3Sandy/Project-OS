{% extends "layout.html" %}
{% block body %}

<script type="text/javascript">

    var column1, column2, column3
    var i1 = 1, i2 = 1, i3 = 1
    var url = $SCRIPT_ROOT + '/_random_numbers'

    function loop1() {
        machine1(url)
        setTimeout(function() {
            if (i1 <= column1) {
                i1++
                loop1()
            }else
                i1 = 1
        }, 100)
    }

    function loop2() {
        machine2(url)
        setTimeout(function() {
            if (i2 <= column2) {
                i2++
                loop2()
            }else
                i2 = 1 
        }, 100)
    }

    function loop3() {
        machine3(url)
        setTimeout(function() {
            if (i3 <= column3) {
                i3++
                loop3()
            }else
                i3 = 1 
        }, 100)
    }

    function start(){

        
        loop1()

        
        loop2()

        
        loop3()
        
    }

    function submit_form(){
    
        var url = $SCRIPT_ROOT + '/_add_numbers'
        var data = {
                a : document.getElementsByName("a")[0].value,
                b : document.getElementsByTagName("input")[1].value
            }
        function success(data){

            document.getElementById("result").innerHTML = data.result

        }

        $.getJSON(url, data, function(data){ success(data) })

    }

    function machine1(url){

        function show(data){

            document.getElementById('column1').innerHTML = data.result

        }

        $.getJSON(url, null, function(data){ show(data) })

    }

    function machine2(url){

        function show(data){

            document.getElementById('column2').innerHTML = data.result

        }

        $.getJSON(url, null, function(data){ show(data) })

    }

    function machine3(url){

        function show(data){

            document.getElementById('column3').innerHTML = data.result

        }

        $.getJSON(url, null, function(data){ show(data) })

    }
    
    window.onload = function(){

        var url1 = $SCRIPT_ROOT + '/_init1'
        var url2 = $SCRIPT_ROOT + '/_init2'
        var url3 = $SCRIPT_ROOT + '/_init3'

        function column1(data){

            column1 = data.result

        }

        function column2(data){

            column2 = data.result

        }

        function column3(data){

            column3 = data.result

        }

        $.getJSON(url1, null, function(data){ column1(data) })
        $.getJSON(url2, null, function(data){ column2(data) })
        $.getJSON(url3, null, function(data){ column3(data) })

        document.getElementById('column1').innerHTML = '5'
        document.getElementById('column2').innerHTML = '5'
        document.getElementById('column3').innerHTML = '5'
        

        // function loop1() {
        //     machine1(url)
        //     setTimeout(function() {
        //         if (i1 <= column1) {
        //             i1++
        //             loop1()
        //         }else
        //             i1 = 1 
        //      }, 100)
        // }
        // loop1()

        // function loop2() {
        //     machine2(url)
        //     setTimeout(function() {
        //         if (i2 <= column2) {
        //             i2++
        //             loop2()
        //         }else
        //             i2 = 1 
        //      }, 100)
        // }
        // loop2()

        // function loop3() {
        //     machine3(url)
        //     setTimeout(function() {
        //         if (i3 <= column3) {
        //             i3++
        //             loop3()
        //         }else
        //             i3 = 1 
        //      }, 100)
        // }
        // loop3()
        
    }

</script>

<h1>jQuery Example</h1>
<h3 id="column1">$$$</h3>
<h3 id="column2">$$$</h3>
<h3 id="column3">$$$</h3>
        <button onclick="start()">Start!</button>
{% endblock %}